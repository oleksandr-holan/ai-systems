# Система оцінки кредитного ризику на основі нечіткої логіки

Система оцінки кредитного ризику, побудована на нечіткій логіці, дозволяє приймати рішення в умовах невизначеності та неточності вхідних даних, що є характерним для оцінки кредитоспроможності позичальника. Розглянемо структуру такої системи, вибір функцій приналежності, алгоритм нечіткого логічного виводу та її реалізацію мовою програмування Python.

## Структура системи, функції приналежності та алгоритм виводу

Процес нечіткого логічного виводу складається з кількох ключових етапів, які формують структуру системи.

**Етапи нечіткого виводу:**

1. **Формування бази знань:** Створення набору правил у форматі "ЯКЩО ... ТО ...", які описують залежність між вхідними та вихідними змінними.
2. **Фазифікація:** Перетворення чітких (конкретних) вхідних значень у нечіткі множини за допомогою функцій приналежності.
3. **Агрегування:** Об'єднання умов у кожному правилі для визначення ступеня його істинності.
4. **Активізація:** Застосування результату агрегування до висновку кожного правила.
5. **Акумуляція:** Об'єднання результатів усіх правил в одну нечітку множину для кожної вихідної змінної.
6. **Дефазифікація:** Перетворення нечіткої вихідної множини у чітке числове значення.

### Структура системи оцінки кредитного ризику

**Вхідні змінні:**

* **Кредитна історія (Credit History):** Оцінює минулу платіжну дисципліну позичальника.
  * **Терм-множини:** Погана, Задовільна, Добра.
* **Рівень доходу (Income Level):** Характеризує фінансову стабільність.
  * **Терм-множини:** Низький, Середній, Високий.
* **Співвідношення боргу до доходу (Debt to Income Ratio):** Показує боргове навантаження.
  * **Терм-множини:** Низьке, Середнє, Високе.

**Вихідна змінна:**

* **Кредитний ризик (Credit Risk):** Рівень ризику невиплати кредиту.
  * **Терм-множини:** Низький, Середній, Високий.

### Вибір функцій приналежності

Функції приналежності визначають ступінь відповідності конкретного значення певній нечіткій множині. Для простоти та наочності оберемо **трикутні** та **трапецієподібні** функції приналежності.

### Алгоритм нечіткого логічного виводу

Будемо використовувати **алгоритм Мамдані**, оскільки він є інтуїтивно зрозумілим та широко розповсюдженим. Основою для логічного виводу є база правил, що визначає зв'язок між вхідними та вихідними змінними.

**Приклади правил:**

* **Правило 1:** ЯКЩО `Рівень доходу` ВИСОКИЙ **АБО** `Кредитна історія` ДОБРА, ТО `Кредитний ризик` НИЗЬКИЙ.
* **Правило 2:** ЯКЩО `Рівень доходу` СЕРЕДНІЙ **І** `Співвідношення боргу до доходу` СЕРЕДНЄ, ТО `Кредитний ризик` СЕРЕДНІЙ.
* **Правило 3:** ЯКЩО `Рівень доходу` НИЗЬКИЙ **І** `Кредитна історія` ПОГАНА, ТО `Кредитний ризик` ВИСОКИЙ.

## Контрольні запитання

### 1. Дайте визначення нечіткої логіки (fuzzy logic)

**Нечітка логіка** — це розширення класичної (булевої) логіки, яке оперує не з двома значеннями істинності (0 — хибно, 1 — істинно), а з **ступенями істинності**. Вона дозволяє значенням бути частково істинними і частково хибними, тобто приймати будь-яке дійсне значення в діапазоні `[0, 1]`.

Головна мета нечіткої логіки, вперше запропонованої Лотфі Заде у 1965 році, — наблизити машинне мислення до людського. Люди рідко мислять в абсолютних категоріях "так/ні". Ми використовуємо розмиті поняття, такі як "тепла погода", "висока людина", "низький ризик". Нечітка логіка надає математичний апарат для роботи з такою невизначеною та неточною інформацією.

### 2. Перелічіть сфери застосування нечіткої логіки, а також її переваги та недоліки

#### Сфери застосування

* **Побутова техніка (Consumer Electronics):** Пральні машини (визначення ступеня забруднення білизни), мікрохвильові печі, кондиціонери (підтримка комфортної температури), фотокамери (автофокусування).
* **Автомобільна промисловість:** Антиблокувальні системи гальм (ABS), автоматичні коробки передач, системи круїз-контролю.
* **Промислова автоматизація:** Керування складними процесами, такими як випал цементу в печах, хімічні реактори, де точну математичну модель побудувати складно.
* **Фінанси та бізнес:** Системи оцінки кредитного ризику, прогнозування фондових ринків, системи підтримки прийняття рішень.
* **Медицина:** Системи діагностики захворювань, аналіз медичних зображень, керування анестезією.
* **Робототехніка та штучний інтелект:** Керування рухом роботів, розпізнавання образів.

#### Переваги

1. **Стійкість до неточності:** Може працювати з неповними, неточними та зашумленими вхідними даними.
2. **Інтуїтивність:** Правила "ЯКЩО ... ТО ..." легко формулюються на основі знань експерта природною мовою.
3. **Моделювання нелінійних систем:** Дозволяє описувати складні системи, для яких важко або неможливо створити точну математичну модель.
4. **Гнучкість:** Систему легко модифікувати, додаючи або змінюючи правила.
5. **Швидка розробка:** Прототип системи можна створити відносно швидко на основі експертних знань.

#### Недоліки

1. **Суб'єктивність:** Вибір функцій приналежності та формування правил залежать від експерта і не завжди є оптимальними.
2. **Відсутність формального методу синтезу:** Немає єдиного алгоритму для створення нечіткої системи; процес часто вимагає налаштування та методу проб і помилок.
3. **Обчислювальна складність:** Дефазифікація (особливо методом центроїда) може бути ресурсоємною для систем реального часу.
4. **Не є універсальним рішенням:** Для задач, що мають точне аналітичне рішення, класичні методи регулювання зазвичай є більш ефективними.

### 3. Опишіть основні операції нечіткої логіки

Основні операції є аналогами класичних логічних операцій **НЕ**, **І**, **АБО**.

* **НЕ (Заперечення, Complement):** Якщо ступінь приналежності елемента `x` до множини `A` дорівнює `μA(x)`, то ступінь приналежності до **НЕ A** дорівнює:
    `μ¬A(x) = 1 - μA(x)`

* **І (Перетин, Intersection, T-norm):** Ця операція об'єднує дві нечіткі множини. Найпоширеніший спосіб — **мінімум**. Ступінь приналежності елемента `x` до множини **A І B** дорівнює:
    `μA∩B(x) = min(μA(x), μB(x))`
    *Приклад у коді:* `rule = ctrl.Rule(income['high'] & history['good'], ...)`

* **АБО (Об'єднання, Union, S-norm):** Ця операція також об'єднує дві множини. Найпоширеніший спосіб — **максимум**. Ступінь приналежності елемента `x` до множини **A АБО B** дорівнює:
    `μA∪B(x) = max(μA(x), μB(x))`
    *Приклад у коді:* `rule = ctrl.Rule(income['high'] | history['good'], ...)`

### 4. Що таке фаззифікатор та дефаззифікатор?

**Фаззифікатор (Fuzzifier)** — це вхідний блок системи нечіткого виводу. Його завдання — перетворити **чітке** (конкретне, числове) вхідне значення у **нечітку** множину. Він визначає **ступінь приналежності** вхідного значення до кожного з лінгвістичних термів, описаних функціями приналежності.

* *Приклад:* Вхідне значення `Температура = 23°C`. Фаззифікатор може видати результат: `{'Тепло': 0.7, 'Жарко': 0.1, 'Прохолодно': 0.0}`.

**Дефаззифікатор (Defuzzifier)** — це вихідний блок системи. Його завдання протилежне: перетворити **нечітку** множину, отриману в результаті роботи нечіткого виводу, у **чітке** числове значення. Це необхідно, оскільки реальні пристрої (наприклад, двигун чи кондиціонер) потребують конкретної команди.

* *Приклад:* Після обробки правил система видала нечітку множину для вихідної змінної "Потужність кондиціонера". Дефаззифікатор обчислює її і видає чітку команду: `Потужність = 65%`. Найпопулярнішим методом дефазифікації є **метод центроїда (центру ваги)**.

### 5. Що таке функція приналежності та яким чином вона формується?

**Функція приналежності (Membership Function)** — це крива або графік, який визначає, наскільки кожен елемент з універсальної множини (діапазону значень) належить до певної нечіткої множини. Вона ставить у відповідність кожному вхідному значенню число від 0 до 1 (ступінь приналежності).

**Способи формування:**

1. **На основі експертних знань (Heuristic):** Це найпоширеніший метод. Експерта в предметній області опитують, щоб визначити межі та форму функцій. Наприклад, у агронома питають: "При якій вологості ґрунт можна вважати 'сухим', 'вологим', 'дуже вологим'?". На основі цих відповідей будуються трикутні, трапецієподібні та інші функції.
2. **На основі даних (Data-driven):** Коли є великий набір даних, можна використовувати алгоритми машинного навчання (наприклад, кластеризацію, нейронні мережі) для автоматичного визначення форми та параметрів функцій приналежності.
3. **Метод проб і помилок:** Створюється початкова модель, яка потім ітеративно налаштовується для досягнення кращої продуктивності системи.

### 6. Що таке лінгвістичні змінні?

**Лінгвістична змінна** — це змінна, значеннями якої є не числа, а слова або фрази з природної мови. Ці слова називаються **термами** (або терм-множинами).

Кожна лінгвістична змінна характеризується:

* **Ім'ям:** наприклад, `Температура`.
* **Терм-множиною:** наприклад, `{'Холодно', 'Прохолодно', 'Тепло', 'Жарко'}`.
* **Універсальною множиною:** діапазоном числових значень, які вона може приймати (напр., від -20°C до +40°C).
* **Функцією приналежності:** для кожного терму з терм-множини існує своя функція приналежності, що пов'язує його з числовими значеннями.

Використання лінгвістичних змінних дозволяє формулювати правила у зручній для людини формі.

### 7. Охарактеризуйте системи нечіткого логічного виводу

**Система нечіткого логічного виводу (Fuzzy Inference System, FIS)** — це система, яка використовує нечітку логіку для перетворення вхідних даних у вихідні на основі бази знань.

Основні компоненти:

1. **База знань (Knowledge Base):** Складається з двох частин:
    * **База даних:** Визначає лінгвістичні змінні та їх функції приналежності.
    * **База правил:** Містить набір правил "ЯКЩО ... ТО ...", що описують логічні зв'язки між вхідними та вихідними змінними.
2. **Фаззифікатор:** Перетворює чіткі вхідні дані в нечіткі.
3. **Механізм виводу (Inference Engine):** Застосовує правила до фаззифікованих даних, щоб отримати нечіткі висновки. Він виконує операції агрегування (об'єднання умов в `ЯКЩО`-частині) та активації (застосування результату до `ТО`-частини).
4. **Дефаззифікатор:** Перетворює нечіткий висновок у чітке вихідне значення.

Існують два основні типи систем виводу: **Мамдані** (використовує нечіткі множини в `ТО`-частині правил) і **Сугено** (використовує математичні функції в `ТО`-частині), кожен з яких має свої переваги.

### 8. Охарактеризуйте системи автоматичного керування, засновані на нечіткій логіці

**Нечіткий регулятор (Fuzzy Logic Controller, FLC)** — це система автоматичного керування, ядром якої є система нечіткого логічного виводу. Він замінює собою класичний ПІД-регулятор або інший закон керування.

**Принцип роботи:**

1. **Входи:** На вхід регулятора зазвичай подаються **помилка керування** (`E` = задане значення - поточне значення) та **швидкість зміни помилки** (`dE/dt`).
2. **База правил:** Правила мають вигляд, що імітує логіку оператора:
    * "ЯКЩО помилка велика позитивна І її швидкість зміни нульова, ТО сильно збільшити керуючий вплив".
    * "ЯКЩО помилка близька до нуля І її швидкість зміни нульова, ТО керуючий вплив не змінювати".
3. **Вихід:** Виходом є керуючий вплив на об'єкт (наприклад, потужність нагрівача, кут повороту керма).

Основна перевага таких систем в тому, що вони не вимагають точної математичної моделі об'єкта керування, що робить їх ідеальними для складних, нелінійних та змінних у часі процесів.

### 9. Опишіть можливості та особливості роботи із Fuzzy Logic Toolbox (пакетом розширення MATLAB). Наведіть інші відомі вам програмні або апаратні системи для роботи із нечіткою логікою

#### Fuzzy Logic Toolbox (MATLAB)

Це потужний інструмент для проектування, моделювання та аналізу систем нечіткої логіки в середовищі MATLAB.

**Можливості та особливості:**

* **Графічний інтерфейс (GUI):** Надає інтерактивні інструменти:
  * **Fuzzy Logic Designer:** Дозволяє візуально створювати всю систему — додавати вхідні/вихідні змінні, редагувати функції приналежності, вводити правила.
  * **Rule Viewer:** Показує в реальному часі, як активуються правила для заданих вхідних значень.
  * **Surface Viewer:** Будує 3D-графік, що показує залежність виходу від двох входів, дозволяючи аналізувати "поверхню керування" системи.
* **Функції командного рядка:** Дозволяють створювати та налаштовувати системи програмно, що зручно для автоматизації та інтеграції.
* **Підтримка типів систем:** Реалізовані алгоритми **Мамдані** та **Сугено**.
* **Інтеграція з Simulink:** Нечіткі регулятори можна вбудовувати у вигляді блоків у динамічні моделі в Simulink для симуляції складних систем керування.
* **Генерація коду:** Можливість генерувати C-код або HDL-код з нечіткої системи для вбудованих систем.

#### Інші програмні та апаратні системи

**Програмні системи:**

* **Python:**
  * **scikit-fuzzy (`skfuzzy`):** Найпопулярніша бібліотека, яку ви використовували в лабораторній роботі. Надає повний функціонал для створення нечітких систем.
  * Інші бібліотеки: `pyfuzzylite`, `simpful`.
* **Java:** `jFuzzyLogic` (стандартизована бібліотека, що відповідає стандарту IEC 61131-7), `FuzzyJ`.
* **C++:** `FuzzyLite` (дуже потужна та швидка бібліотека від автора jFuzzyLogic).

**Апаратні системи:**
Хоча зараз нечітка логіка частіше реалізується програмно на звичайних мікроконтролерах, існують і спеціалізовані рішення:

* **Спеціалізовані мікропроцесори (Fuzzy Processors):** У 90-х роках розроблялися процесори, що мали набір інструкцій для прискореного виконання нечітких операцій.
* **FPGA (ПЛІС) та ASIC:** Логіку нечіткого виводу можна реалізувати безпосередньо в апаратній логіці, що забезпечує максимальну швидкодію для систем реального часу.

## Джерела

1. <https://aistudio.google.com/app/prompts?state=%7B%22ids%22:%5B%221ZzNDAa5mqJLZIf4SOy66uOxpfVIkODDj%22%5D,%22action%22:%22open%22,%22userId%22:%22104200205768650044534%22,%22resourceKeys%22:%7B%7D%7D&usp=sharing>
